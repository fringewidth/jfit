
from scipy.optimize import curve_fit
import numpy as np
from matplotlib import pyplot as plt
from math import factorial

def objective(x,a,b,c):
	return a*x*np.log2(x+b)+c

x=np.arange(0, 5000, 10)
y=[4700, 1300, 800, 1000, 1500, 1600, 1600, 2000, 1900, 2300, 2600, 2500, 3000, 2900, 4300, 3500, 3500, 3900, 3800, 4100, 5400, 4300, 4800, 18800, 4900, 6300, 6100, 5800, 5900, 6800, 6400, 6700, 7400, 7100, 7300, 7900, 8000, 7700, 9100, 8300, 9500, 18000, 12300, 13200, 11800, 13200, 33000, 13200, 12900, 12900, 13300, 12800, 13700, 13400, 14700, 14400, 14200, 14900, 14000, 14700, 15200, 15900, 15700, 16000, 16800, 15400, 17100, 16800, 17700, 18500, 31200, 16600, 17300, 17300, 17700, 17700, 20000, 18100, 18300, 17800, 17900, 19200, 18900, 19100, 20800, 19000, 19200, 19700, 20100, 33400, 19300, 19400, 19500, 19900, 21200, 42000, 32300, 24500, 25200, 32500, 25900, 24500, 24900, 24900, 26600, 25800, 6000, 5500, 5700, 5500, 5500, 7500, 5600, 5600, 5700, 5800, 5800, 6300, 7400, 6000, 6000, 6100, 6100, 6200, 6200, 7800, 6300, 6500, 6600, 6700, 6600, 8900, 6900, 6600, 6600, 7100, 7100, 29200, 7100, 7000, 7000, 7200, 7200, 9100, 7300, 7300, 7500, 7300, 7700, 9400, 7500, 8100, 8200, 7700, 10300, 7800, 7800, 8000, 7900, 8300, 10900, 8200, 8000, 8500, 8200, 11600, 8300, 8500, 8600, 8200, 10800, 8300, 9200, 8600, 11300, 8700, 8800, 9400, 9400, 11500, 8900, 10300, 9700, 14400, 9200, 9000, 9100, 9200, 11000, 9500, 12500, 7500, 11700, 7000, 6400, 4600, 5800, 4900, 6500, 6500, 4900, 5500, 4900, 5000, 5000, 5200, 5600, 5000, 4900, 6900, 5000, 6100, 5300, 5000, 5000, 5100, 5900, 5200, 5200, 5200, 6300, 6900, 5200, 7000, 5600, 5300, 5300, 6900, 5500, 5400, 5500, 5900, 5400, 5500, 6000, 7400, 5500, 7300, 6800, 5600, 5700, 34600, 7000, 7600, 7600, 24300, 5800, 5800, 29800, 6000, 5800, 5900, 22000, 6000, 6200, 32000, 9300, 6100, 8000, 21000, 6100, 8100, 20700, 6300, 6200, 21100, 8600, 8400, 31200, 14700, 13100, 78100, 13300, 13400, 55700, 13900, 13100, 59900, 14300, 13900, 56900, 13900, 13700, 54500, 13700, 13600, 59700, 13700, 13900, 60300, 14000, 13900, 76400, 13900, 13600, 60400, 13900, 13800, 58200, 14200, 14200, 59100, 14700, 15000, 61700, 2300, 1800, 1800, 2000, 1800, 1800, 1800, 2100, 2000, 1800, 1800, 2000, 1800, 1900, 2600, 1900, 1900, 1900, 2000, 2800, 1800, 1800, 1500, 1500, 1500, 1500, 1700, 1700, 1800, 1500, 1500, 1800, 1800, 1600, 1700, 1500, 1600, 1600, 1800, 1600, 1500, 1800, 1500, 1600, 1700, 1600, 1600, 1500, 1900, 1800, 1600, 1700, 1600, 1800, 1900, 1600, 1900, 1900, 1600, 1700, 1800, 1700, 1700, 2000, 1700, 3700, 1600, 1700, 2000, 2100, 2000, 5100, 2400, 2600, 2900, 1900, 4200, 3000, 3200, 2400, 2500, 2400, 2300, 2900, 2800, 1700, 1700, 2000, 1800, 2000, 1800, 1800, 2200, 2100, 2200, 1900, 2000, 2000, 2100, 2000, 2000, 1800, 1900, 2200, 2100, 1800, 2300, 1800, 3000, 2000, 2200, 2700, 1900, 2200, 2000, 2200, 2000, 2100, 2500, 2100, 2300, 2000, 2300, 2300, 2100, 2100, 1900, 2500, 2200, 2700, 2100, 2500, 8900, 2600, 2700, 2200, 6200, 5700, 3000, 3400, 3500, 3100, 2600, 2600, 2600, 2600, 2600, 2800, 2600, 2600, 2600, 2600, 2700, 2700, 2600, 2600, 2600, 2600, 2700, 2700, 3100, 2700, 2700, 2700, 2700, 3400, 2900, 2900, 3100, 2800, 2700, 3100, 2800, 2800, 2900, 2800, 3100, 2800, 2800, 2700, 2800, 3100, 2800, 2800, 2800, 4300, 2600, 3000, 2700, 2700, 3000, 2700, 2600, 2800, 2700]
popt, _ = curve_fit(objective, x, y)
a,b,c = popt
x_line=np.linspace(0,5000,500)
y_line=objective(x,a,b,c)
plt.style.use("dark_background")
plt.scatter(x, y, marker=".")
plt.plot(x_line, y_line,"r-")
plt.show()