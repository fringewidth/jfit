
from scipy.optimize import curve_fit
import numpy as np
from matplotlib import pyplot as plt
from math import factorial

def objective(x,a,b):
	return a*x*log2(x)+b

x=np.arange(0, 5000, 10)
y=[3003, 3768, 10624, 26305, 43474, 136553, 93908, 124663, 162475, 203257, 250379, 307256, 735207, 359769, 63353, 150544, 3107657, 81616, 90150, 100639, 111964, 190794, 5506626, 396423, 160965, 929907, 507407, 479223, 217368, 233540, 250281, 266998, 284782, 302733, 321385, 343428, 362094, 382386, 787488, 479086, 521757, 470945, 580358, 164915, 157137, 159734, 164661, 168505, 172455, 178324, 186232, 191388, 197857, 201212, 209378, 211107, 218172, 571239, 177429, 185876, 193916, 197736, 212779, 221878, 218536, 229868, 232471, 238280, 245015, 264098, 260996, 267202, 283799, 281592, 301768, 297767, 326774, 649683, 318775, 329416, 346714, 505243, 371489, 377098, 370986, 382373, 889504, 406580, 1005261, 767965, 3633313, 1002670, 978120, 997940, 2922380, 474164, 493814, 508667, 841820, 1472063, 528494, 547705, 563875, 566398, 576890, 1047892, 1004558, 604778, 3009093, 625115, 637432, 646399, 667169, 686139, 684127, 720897, 766574, 730606, 753771, 768316, 772672, 815496, 783432, 814992, 841736, 915196, 891842, 904615, 909015, 898928, 909537, 988668, 961141, 939600, 950833, 1631602, 1852702, 1899767, 1777323, 1113506, 1851233, 1907935, 1879819, 1746809, 8798257, 1827180, 2150099, 2028077, 2076060, 4036456, 8826794, 2270288, 1718820, 3198617, 1763326, 1731274, 2553023, 1764391, 2077981, 2456607, 1924757, 2595903, 1832911, 1936738, 2306414, 1870011, 3701925, 1551266, 1487305, 1490006, 1506358, 1526632, 1606717, 1599227, 1719402, 2618826, 2629284, 2678102, 2688945, 2740567, 2834079, 2824470, 2827648, 2857945, 2971527, 2921259, 2957456, 2969768, 3022785, 3051332, 3074131, 3116135, 3147077, 3174841, 3238386, 3246506, 3283464, 3341677, 3351253, 3387405, 5009278, 2557439, 2164105, 2371596, 2392993, 2194372, 2304693, 2274890, 5047256, 9014965, 7332654, 7675284, 17453433, 3312806, 13638251, 3011635, 13083369, 2570594, 3648516, 4327178, 2805941, 2761906, 2585018, 2698715, 5343302, 5408597, 4479631, 5111760, 5253756, 2799057, 3662773, 2826722, 2880758, 2833610, 3356316, 7316026, 4117038, 4552842, 5022312, 4375235, 8865306, 3564279, 3091953, 3100994, 3135884, 3168817, 3260235, 3338501, 3453098, 3429971, 3353234, 3291791, 3475540, 3385704, 3492969, 3543111, 3466751, 3594415, 3532290, 3506743, 3684566, 3712360, 3715189, 3632065, 3986304, 3773471, 3680284, 3802949, 4067531, 3857057, 3851635, 3844806, 3858700, 4141304, 3960874, 3971645, 4026700, 4440725, 4025339, 4245678, 7107949, 4262100, 4205009, 4368080, 4203537, 4232733, 4472160, 4482968, 4320615, 4417912, 13982211, 6006928, 5463706, 18776946, 19997440, 15556168, 6534354, 6460139, 11100844, 6905474, 9799601, 4780354, 12039473, 20833339, 9247218, 16520793, 11817588, 14332266, 7580753, 6086731, 12514412, 9230149, 9397898, 9187602, 9462281, 8734855, 11192939, 6881321, 7615309, 6991036, 4579915, 28398604, 6752600, 12000553, 10377447, 9443309, 9976936, 9746069, 10256374, 12000553, 8000370, 12000553, 5375577, 5883339, 6833348, 7504419, 9735813, 12204793, 19618986, 8832530, 10356974, 10558413, 10610690, 10747896, 6656734, 7175755, 11430085, 6451186, 6577291, 6435533, 6454061, 9531552, 10616274, 6664804, 6637622, 9862320, 10363598, 7007166, 6783270, 7278509, 7033670, 9871516, 7493081, 7386589, 7110134, 7372718, 11141243, 11410091, 7491497, 9779514, 11856894, 7706532, 7453300, 12013869, 12040711, 12230345, 11791433, 8408740, 7622050, 7934927, 8268023, 8147830, 7731378, 11446725, 12925524, 12489657, 8076515, 8809181, 10176531, 9074504, 8117155, 8185373, 8930576, 8272970, 8127055, 9149651, 8417103, 9276863, 8978302, 8496813, 8601364, 8507354, 9287186, 8752810, 8797139, 8762131, 9299105, 10853224, 9602999, 9174003, 8794096, 11050086, 8963369, 9914482, 24656410, 14556743, 9069139, 9431191, 12128449, 16445631, 11036414, 10914373, 9723533, 9952248, 9983985, 13146686, 12927975, 10430879, 9923576, 12869591, 15940584, 16013428, 16041289, 13708752, 11285925, 16311484, 16502304, 16530926, 16661639, 11753200, 11006765, 10246941, 10786866, 12291778, 15220586, 10357443, 11467825, 10741269, 10776404, 11178298, 14563728, 10911710, 10605691, 13384551, 13377120, 10878838, 11377931, 15656702, 18241598, 18383224, 18378289, 12011537, 11577385, 12431769, 16374643, 15207230, 15173559, 20037140, 40136804, 48050618, 40572687, 16208660, 30960559, 15403716, 19917476, 11823426, 14082516, 12494262, 18213501, 19480423, 24658737, 13552105, 13904807, 13840240, 18095879, 14888575, 16986017, 18253315, 16289554, 17649628, 16697444, 19122622, 17176324, 16643952, 17189230, 16954617, 16910637, 13313365, 20741889, 21511916]
popt, _ = curve_fit(objective, x, y)
a,b = popt
x_line=np.linspace(0,5000,500)
y_line=objective(x,a,b)
plt.scatter(x, y)
plt.plot(x_line, y_line,"r-")
plt.show()